<!doctype html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; style-src 'self' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; script-src 'self';"
    />
    <title>TermLauncher</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles/variables.css" />
    <link rel="stylesheet" href="styles/base.css" />
    <link rel="stylesheet" href="styles/layout.css" />
    <link rel="stylesheet" href="styles/components.css" />
  </head>
  <body>
    <!-- 標題欄 -->
    <div class="titlebar">
      <div class="titlebar-title"><span>🚀</span> TermLauncher</div>
      <div class="titlebar-buttons">
        <button
          class="titlebar-btn"
          id="btnMinimize"
          aria-label="最小化視窗"
          data-i18n-aria="ui.titlebar.minimize"
        >
          ─
        </button>
        <button
          class="titlebar-btn close"
          id="btnClose"
          aria-label="關閉視窗"
          data-i18n-aria="ui.titlebar.close"
        >
          ✕
        </button>
      </div>
    </div>

    <!-- 主容器 -->
    <div class="main-container">
      <!-- 分頁標籤 -->
      <div class="tabs">
        <button class="tab active" data-tab="directories" data-i18n="ui.tabs.directories">
          📁 目錄
        </button>
        <button class="tab" data-tab="settings" data-i18n="ui.tabs.settings">⚙️ 設定</button>
      </div>

      <!-- 內容區 -->
      <div class="content">
        <!-- 目錄分頁 -->
        <div class="tab-content active" id="directories-tab">
          <!-- 搜尋列 -->
          <div class="search-bar">
            <div class="search-input-wrapper">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <circle cx="11" cy="11" r="8" />
                <path d="m21 21-4.35-4.35" />
              </svg>
              <input
                type="text"
                class="search-input"
                id="searchInput"
                placeholder="搜尋目錄..."
                data-i18n-placeholder="ui.search.placeholder"
                aria-label="搜尋目錄"
                data-i18n-aria="ui.search.placeholder"
              />
            </div>
            <select
              class="filter-select"
              id="groupFilter"
              aria-label="篩選群組"
              data-i18n-aria="ui.search.allGroups"
            >
              <option value="" data-i18n="ui.search.allGroups">所有群組</option>
            </select>
          </div>

          <!-- 新增目錄區塊 -->
          <div class="add-section">
            <div class="section-header">
              <div class="section-title" data-i18n="ui.addDirectory.sectionTitle">➕ 新增目錄</div>
              <button
                class="toggle-btn"
                id="btnToggleAddForm"
                aria-label="展開或收起新增目錄表單"
                aria-expanded="false"
                data-i18n="ui.addDirectory.expand"
              >
                展開
              </button>
            </div>
            <div class="add-form" id="addForm">
              <div class="input-row">
                <div class="input-group">
                  <label data-i18n="ui.addDirectory.name">名稱</label>
                  <input
                    type="text"
                    id="dirName"
                    placeholder="例如：我的專案"
                    data-i18n-placeholder="ui.addDirectory.namePlaceholder"
                  />
                </div>
                <div class="input-group" style="max-width: 180px">
                  <label data-i18n="ui.addDirectory.type">終端類型</label>
                  <select id="dirType">
                    <!-- 動態渲染終端選項 -->
                  </select>
                </div>
              </div>
              <div class="input-group">
                <label data-i18n="ui.addDirectory.path">路徑</label>
                <div class="path-input-wrapper">
                  <input
                    type="text"
                    id="dirPath"
                    placeholder="例如：D:\Projects\my-app"
                    data-i18n-placeholder="ui.addDirectory.pathPlaceholder"
                  />
                  <button
                    class="browse-btn"
                    id="btnBrowsePath"
                    aria-label="瀏覽並選擇資料夾"
                    data-i18n="ui.addDirectory.browse"
                    data-i18n-aria="ui.addDirectory.browse"
                  >
                    瀏覽...
                  </button>
                </div>
              </div>
              <div class="input-group">
                <label data-i18n="ui.addDirectory.group">群組</label>
                <select id="dirGroup"></select>
              </div>
              <button
                class="btn btn-primary"
                id="btnAddDirectory"
                aria-label="新增目錄"
                data-i18n="ui.addDirectory.addButton"
                data-i18n-aria="ui.addDirectory.addButton"
              >
                ➕ 新增目錄
              </button>
            </div>
          </div>

          <!-- 最近使用區塊 -->
          <div class="recent-section" id="recentSection" style="display: none">
            <h3 data-i18n="ui.recent.title">🕐 最近使用</h3>
            <div class="recent-list" id="recentList"></div>
          </div>

          <!-- 目錄群組列表 -->
          <div id="directoryGroups"></div>
        </div>

        <!-- 設定分頁 -->
        <div class="tab-content" id="settings-tab">
          <!-- 一般設定 -->
          <div class="settings-section">
            <h3 data-i18n="ui.settings.general.title">⚙️ 一般設定</h3>
            <div class="setting-item">
              <div class="setting-label">
                <span data-i18n="ui.settings.general.theme">主題</span>
                <small data-i18n="ui.settings.general.themeDesc">切換介面的外觀主題</small>
              </div>
              <select class="theme-select" id="themeSelect" aria-label="選擇主題">
                <option value="dark" data-i18n="ui.settings.general.themeDark">🌙 深色</option>
                <option value="light" data-i18n="ui.settings.general.themeLight">☀️ 淺色</option>
              </select>
            </div>
            <div class="setting-item">
              <div class="setting-label">
                <span data-i18n="ui.settings.general.language">語言</span>
                <small data-i18n="ui.settings.general.languageDesc">選擇介面顯示語言</small>
              </div>
              <select class="theme-select" id="languageSelect" aria-label="選擇語言"></select>
            </div>
            <div class="setting-item">
              <div class="setting-label">
                <span data-i18n="ui.settings.general.autoLaunch">開機自動啟動</span>
                <small data-i18n="ui.settings.general.autoLaunchDesc">系統開機時自動啟動程式</small>
              </div>
              <label class="switch">
                <input
                  type="checkbox"
                  id="autoLaunch"
                  aria-label="開機自動啟動"
                  data-i18n-aria="ui.settings.general.autoLaunch"
                />
                <span class="slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div class="setting-label">
                <span data-i18n="ui.settings.general.startMinimized">啟動時最小化</span>
                <small data-i18n="ui.settings.general.startMinimizedDesc"
                  >程式啟動時自動最小化到系統托盤</small
                >
              </div>
              <label class="switch">
                <input
                  type="checkbox"
                  id="startMinimized"
                  aria-label="啟動時最小化"
                  data-i18n-aria="ui.settings.general.startMinimized"
                />
                <span class="slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div class="setting-label">
                <span data-i18n="ui.settings.general.minimizeToTray">關閉時最小化到托盤</span>
                <small data-i18n="ui.settings.general.minimizeToTrayDesc"
                  >點擊關閉按鈕時最小化而非結束</small
                >
              </div>
              <label class="switch">
                <input
                  type="checkbox"
                  id="minimizeToTray"
                  checked
                  aria-label="關閉時最小化到托盤"
                  data-i18n-aria="ui.settings.general.minimizeToTray"
                />
                <span class="slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div class="setting-label">
                <span data-i18n="ui.settings.general.globalShortcut">全域快捷鍵</span>
                <small data-i18n="ui.settings.general.globalShortcutDesc"
                  >按下快捷鍵顯示/隱藏視窗</small
                >
              </div>
              <div style="display: flex; gap: 8px; align-items: center; flex-shrink: 0">
                <input
                  type="text"
                  class="shortcut-input"
                  id="globalShortcut"
                  value="Alt+Space"
                  aria-label="全域快捷鍵設定"
                  data-i18n-aria="ui.settings.general.globalShortcut"
                  readonly
                />
                <button
                  class="btn-icon"
                  id="btnRecordShortcut"
                  title="按鍵錄製"
                  aria-label="錄製快捷鍵"
                  data-i18n-title="ui.settings.general.recordShortcut"
                  data-i18n-aria="ui.settings.general.recordShortcut"
                >
                  🎹
                </button>
              </div>
            </div>
          </div>

          <!-- 終端管理 -->
          <div class="settings-section">
            <h3 data-i18n="ui.settings.terminals.title">🖥️ 終端管理</h3>
            <div class="terminals-list" id="terminalsList"></div>
            <div class="terminal-form" id="terminalForm">
              <div class="terminal-form-header">
                <span id="terminalFormTitle" data-i18n="ui.settings.terminals.addNew"
                  >新增自訂終端</span
                >
                <button
                  class="btn-icon"
                  id="btnCancelTerminal"
                  title="取消"
                  aria-label="取消編輯"
                  style="display: none"
                >
                  ✕
                </button>
              </div>
              <input type="hidden" id="terminalEditId" value="" />
              <div class="input-row">
                <div class="input-group">
                  <label data-i18n="ui.settings.terminals.name">名稱</label>
                  <input
                    type="text"
                    id="terminalName"
                    placeholder="例如：Git Bash"
                    data-i18n-placeholder="ui.settings.terminals.namePlaceholder"
                  />
                </div>
                <div class="input-group" style="max-width: 80px">
                  <label data-i18n="ui.settings.terminals.icon">圖示</label>
                  <input
                    type="text"
                    id="terminalIcon"
                    placeholder="🔧"
                    maxlength="2"
                    class="icon-input"
                  />
                </div>
              </div>
              <div class="input-group">
                <label data-i18n="ui.settings.terminals.command">啟動指令</label>
                <input
                  type="text"
                  id="terminalCommand"
                  placeholder='例如："C:\Program Files\Git\bin\bash.exe" --cd {path}'
                  data-i18n-placeholder="ui.settings.terminals.commandPlaceholder"
                  class="mono-input"
                />
                <small class="hint" data-i18n="ui.settings.terminals.commandHint"
                  >使用 {path} 作為路徑佔位符</small
                >
              </div>
              <div class="input-group">
                <label data-i18n="ui.settings.terminals.pathFormat">路徑格式</label>
                <select id="terminalPathFormat">
                  <option value="windows" data-i18n="ui.settings.terminals.pathWindows">
                    Windows (C:\path)
                  </option>
                  <option value="unix" data-i18n="ui.settings.terminals.pathUnix">
                    WSL (/mnt/c/path)
                  </option>
                </select>
              </div>
              <button
                class="btn btn-primary"
                id="btnSaveTerminal"
                aria-label="儲存終端"
                data-i18n="ui.settings.terminals.save"
              >
                儲存終端
              </button>
            </div>
          </div>

          <!-- 群組管理 -->
          <div class="settings-section">
            <h3 data-i18n="ui.settings.groups.title">🏷️ 群組管理</h3>
            <div class="groups-list" id="groupsList"></div>
            <div class="add-group-form">
              <input
                type="text"
                id="newGroupName"
                placeholder="新群組名稱"
                data-i18n-placeholder="ui.settings.groups.newGroupPlaceholder"
                aria-label="新群組名稱"
                data-i18n-aria="ui.settings.groups.newGroupPlaceholder"
              />
              <button
                class="btn btn-primary"
                id="btnAddGroup"
                aria-label="新增群組"
                data-i18n="ui.settings.groups.add"
                data-i18n-aria="ui.settings.groups.add"
              >
                新增
              </button>
            </div>
          </div>

          <!-- 資料管理 -->
          <div class="settings-section">
            <h3 data-i18n="ui.settings.data.title">💾 資料管理</h3>
            <div class="import-export-buttons">
              <button
                class="btn-secondary"
                id="btnExportConfig"
                aria-label="匯出設定檔"
                data-i18n="ui.settings.data.export"
                data-i18n-aria="ui.settings.data.export"
              >
                📤 匯出設定
              </button>
              <button
                class="btn-secondary"
                id="btnImportConfig"
                aria-label="匯入設定檔"
                data-i18n="ui.settings.data.import"
                data-i18n-aria="ui.settings.data.import"
              >
                📥 匯入設定
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast 通知 -->
    <div class="toast" id="toast">
      <span class="toast-icon">✓</span>
      <span class="toast-text" id="toastText"></span>
    </div>

    <!-- 載入應用程式腳本 -->
    <script type="module" src="scripts/app.js"></script>
  </body>
</html>
