# TermLauncher æŠ€è¡“æ¶æ§‹æ–‡æª”

> ç‰ˆæœ¬ï¼š1.1.0
> æ›´æ–°æ—¥æœŸï¼š2025-01-24

---

## 1. æŠ€è¡“æ£§ç¸½è¦½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  TermLauncher                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Frontend        â”‚  Electron Renderer Process   â”‚
â”‚  (UI Layer)      â”‚  - HTML5 / CSS3 (æ¨¡çµ„åŒ–)      â”‚
â”‚                  â”‚  - ES Modules JavaScript     â”‚
â”‚                  â”‚  - Google Fonts              â”‚
â”‚                  â”‚  - å¤šä¸»é¡Œæ”¯æ´                 â”‚
â”‚                  â”‚  - å¤šèªç³»æ”¯æ´ (i18n)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Preload         â”‚  Context Bridge              â”‚
â”‚  (Security)      â”‚  - å®‰å…¨ API æš´éœ²              â”‚
â”‚                  â”‚  - contextIsolation: true    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Backend         â”‚  Electron Main Process       â”‚
â”‚  (Core Layer)    â”‚  - Node.js (æ¨¡çµ„åŒ–)           â”‚
â”‚                  â”‚  - File System (fs)          â”‚
â”‚                  â”‚  - Child Process (spawn)     â”‚
â”‚                  â”‚  - æ—¥èªŒè¨˜éŒ„ (logger)          â”‚
â”‚                  â”‚  - åœ‹éš›åŒ– (i18n)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  System          â”‚  Windows APIs                â”‚
â”‚  Integration     â”‚  - Windows Terminal (wt.exe) â”‚
â”‚                  â”‚  - WSL (wsl.exe)             â”‚
â”‚                  â”‚  - Global Shortcuts          â”‚
â”‚                  â”‚  - System Tray               â”‚
â”‚                  â”‚  - Auto Launch (Registry)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. å°ˆæ¡ˆçµæ§‹

```
TermLauncher/
â”œâ”€â”€ src/                        # ğŸ“ åŸå§‹ç¢¼ç›®éŒ„
â”‚   â”œâ”€â”€ main/                   # Electron ä¸»é€²ç¨‹
â”‚   â”‚   â”œâ”€â”€ index.js           # ä¸»é€²ç¨‹å…¥å£é»
â”‚   â”‚   â”œâ”€â”€ config.js          # é…ç½®ç®¡ç†æ¨¡çµ„
â”‚   â”‚   â”œâ”€â”€ terminal.js        # çµ‚ç«¯å•Ÿå‹•æ¨¡çµ„
â”‚   â”‚   â”œâ”€â”€ window.js          # è¦–çª—ç®¡ç†æ¨¡çµ„
â”‚   â”‚   â”œâ”€â”€ tray.js            # ç³»çµ±æ‰˜ç›¤æ¨¡çµ„
â”‚   â”‚   â”œâ”€â”€ shortcuts.js       # å¿«æ·éµç®¡ç†æ¨¡çµ„
â”‚   â”‚   â”œâ”€â”€ ipc-handlers.js    # IPC äº‹ä»¶è™•ç†æ¨¡çµ„
â”‚   â”‚   â”œâ”€â”€ i18n.js            # åœ‹éš›åŒ–æ¨¡çµ„ï¼ˆä¸»é€²ç¨‹ï¼‰
â”‚   â”‚   â””â”€â”€ logger.js          # æ—¥èªŒè¨˜éŒ„æ¨¡çµ„
â”‚   â”‚
â”‚   â”œâ”€â”€ preload/                # Preload è…³æœ¬
â”‚   â”‚   â””â”€â”€ preload.js         # Context Bridge API
â”‚   â”‚
â”‚   â”œâ”€â”€ renderer/               # å‰ç«¯æ¸²æŸ“é€²ç¨‹
â”‚   â”‚   â”œâ”€â”€ index.html         # HTML çµæ§‹
â”‚   â”‚   â”œâ”€â”€ styles/            # æ¨£å¼æª”æ¡ˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ variables.css  # CSS è®Šæ•¸å®šç¾©ï¼ˆå«ä¸»é¡Œï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ base.css       # åŸºç¤æ¨£å¼
â”‚   â”‚   â”‚   â”œâ”€â”€ components.css # å…ƒä»¶æ¨£å¼
â”‚   â”‚   â”‚   â””â”€â”€ layout.css     # ä½ˆå±€æ¨£å¼
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ scripts/           # JavaScript æ¨¡çµ„
â”‚   â”‚       â”œâ”€â”€ app.js         # æ‡‰ç”¨å…¥å£
â”‚   â”‚       â”œâ”€â”€ api.js         # IPC é€šè¨Šå°è£
â”‚   â”‚       â”œâ”€â”€ state.js       # ç‹€æ…‹ç®¡ç†
â”‚   â”‚       â”œâ”€â”€ i18n.js        # åœ‹éš›åŒ–æ¨¡çµ„ï¼ˆæ¸²æŸ“é€²ç¨‹ï¼‰
â”‚   â”‚       â”œâ”€â”€ ui/            # UI æ¨¡çµ„
â”‚   â”‚       â”‚   â”œâ”€â”€ tabs.js        # åˆ†é åˆ‡æ›
â”‚   â”‚       â”‚   â”œâ”€â”€ directories.js # ç›®éŒ„åˆ—è¡¨
â”‚   â”‚       â”‚   â”œâ”€â”€ settings.js    # è¨­å®šé é¢
â”‚   â”‚       â”‚   â””â”€â”€ toast.js       # é€šçŸ¥æç¤º
â”‚   â”‚       â””â”€â”€ utils/
â”‚   â”‚           â””â”€â”€ shortcuts.js   # å¿«æ·éµéŒ„è£½
â”‚   â”‚
â”‚   â””â”€â”€ locales/                # èªç³»æª”æ¡ˆç›®éŒ„
â”‚       â”œâ”€â”€ zh-TW.json         # ç¹é«”ä¸­æ–‡
â”‚       â””â”€â”€ en-US.json         # è‹±æ–‡
â”‚
â”œâ”€â”€ docs/                       # ğŸ“š æ–‡æª”ç›®éŒ„
â”‚   â”œâ”€â”€ PRD.md                 # ç”¢å“éœ€æ±‚æ–‡æª”
â”‚   â”œâ”€â”€ ARCHITECTURE.md        # æŠ€è¡“æ¶æ§‹æ–‡æª”ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â”‚   â”œâ”€â”€ UI_DESIGN.md           # UI è¨­è¨ˆæ–‡æª”
â”‚   â”œâ”€â”€ PROGRESS.md            # é–‹ç™¼é€²åº¦è¿½è¹¤
â”‚   â””â”€â”€ RELEASE.md             # ç™¼å¸ƒæŒ‡å—
â”‚
â”œâ”€â”€ assets/                     # ğŸ¨ è³‡æºæª”æ¡ˆ
â”‚   â”œâ”€â”€ icon.ico               # æ‡‰ç”¨åœ–ç¤º (Windows)
â”‚   â”œâ”€â”€ icon.png               # æ‡‰ç”¨åœ–ç¤º (é€šç”¨)
â”‚   â”œâ”€â”€ icon.svg               # æ‡‰ç”¨åœ–ç¤º (åŸå§‹æª”)
â”‚   â””â”€â”€ tray-icon.png          # æ‰˜ç›¤åœ–ç¤º
â”‚
â”œâ”€â”€ dist/                       # ğŸ“¦ æ‰“åŒ…è¼¸å‡ºç›®éŒ„
â”‚
â”œâ”€â”€ package.json               # å°ˆæ¡ˆé…ç½®
â”œâ”€â”€ .prettierrc                # Prettier é…ç½®
â”œâ”€â”€ .gitattributes             # Git æ›è¡Œç¬¦é…ç½®
â”œâ”€â”€ .gitignore                 # Git å¿½ç•¥è¦å‰‡
â”œâ”€â”€ README.md                  # å°ˆæ¡ˆèªªæ˜
â””â”€â”€ LICENSE                    # æˆæ¬Šæ¢æ¬¾
```

---

## 3. æ ¸å¿ƒæ¨¡çµ„è¨­è¨ˆ

### 3.1 ä¸»é€²ç¨‹æ¨¡çµ„ (src/main/)

| æ¨¡çµ„              | è·è²¬                         |
| ----------------- | ---------------------------- |
| `index.js`        | æ‡‰ç”¨ç¨‹å¼å…¥å£ã€ç”Ÿå‘½é€±æœŸç®¡ç†   |
| `config.js`       | é…ç½®æª”çš„è®€å–ã€å„²å­˜ã€é·ç§»     |
| `terminal.js`     | çµ‚ç«¯å•Ÿå‹•é‚è¼¯ã€å‰ç½®é©—è­‰       |
| `window.js`       | ä¸»è¦–çª—å»ºç«‹èˆ‡ç®¡ç†             |
| `tray.js`         | ç³»çµ±æ‰˜ç›¤åœ–ç¤ºèˆ‡é¸å–®           |
| `shortcuts.js`    | å…¨åŸŸå¿«æ·éµè¨»å†Š               |
| `ipc-handlers.js` | IPC äº‹ä»¶è™•ç†                 |
| `i18n.js`         | èªç³»æª”æ¡ˆæƒæã€è¼‰å…¥ã€ç¿»è­¯     |
| `logger.js`       | æ—¥èªŒè¨˜éŒ„ã€æª”æ¡ˆè¼¸å‡ºã€è‡ªå‹•æ¸…ç† |

### 3.2 Preload å®‰å…¨æ©Ÿåˆ¶ (src/preload/)

é€é `contextBridge` å®‰å…¨æš´éœ² API çµ¦æ¸²æŸ“é€²ç¨‹ï¼š

```javascript
// preload.js
contextBridge.exposeInMainWorld('electronAPI', {
  getConfig: () => ipcRenderer.invoke('get-config'),
  saveConfig: config => ipcRenderer.invoke('save-config', config),
  openTerminal: dir => ipcRenderer.invoke('open-terminal', dir),
  getAutoLaunch: () => ipcRenderer.invoke('get-auto-launch'),
  setAutoLaunch: enabled => ipcRenderer.invoke('set-auto-launch', enabled),
  getAvailableLocales: () => ipcRenderer.invoke('get-available-locales'),
  loadLocale: code => ipcRenderer.invoke('load-locale', code),
  // ... å…¶ä»– API
});
```

### 3.3 æ¸²æŸ“é€²ç¨‹æ¨¡çµ„ (src/renderer/scripts/)

| æ¨¡çµ„                 | è·è²¬                           |
| -------------------- | ------------------------------ |
| `app.js`             | æ‡‰ç”¨å…¥å£ã€åˆå§‹åŒ–ã€æ•´åˆæ‰€æœ‰æ¨¡çµ„ |
| `api.js`             | å°è£ `window.electronAPI`      |
| `state.js`           | å…¨åŸŸé…ç½®ç‹€æ…‹ç®¡ç†               |
| `i18n.js`            | å‰ç«¯ç¿»è­¯ã€èªè¨€åˆ‡æ›ã€DOM æ›´æ–°   |
| `ui/tabs.js`         | åˆ†é åˆ‡æ›é‚è¼¯                   |
| `ui/directories.js`  | ç›®éŒ„åˆ—è¡¨çš„æ¸²æŸ“èˆ‡æ“ä½œ           |
| `ui/settings.js`     | è¨­å®šé é¢çš„æ¸²æŸ“èˆ‡æ“ä½œ           |
| `ui/toast.js`        | é€šçŸ¥æç¤º                       |
| `utils/shortcuts.js` | å¿«æ·éµéŒ„è£½èˆ‡é©—è­‰               |

### 3.4 é…ç½®ç®¡ç†

**é…ç½®æª”ä½ç½®**ï¼š`%APPDATA%/termlauncher/config.json`

**é…ç½®æª”çµæ§‹**ï¼š

```javascript
{
  "directories": [
    {
      "id": 1706123456789,        // å”¯ä¸€è­˜åˆ¥ç¢¼ (timestamp)
      "name": "æˆ‘çš„å°ˆæ¡ˆ",          // é¡¯ç¤ºåç¨±
      "path": "D:\\Projects\\app", // Windows è·¯å¾‘
      "terminalId": "wsl-ubuntu",  // çµ‚ç«¯é¡å‹ ID
      "group": "é è¨­",             // æ‰€å±¬ç¾¤çµ„
      "lastUsed": 1706123456789   // æœ€å¾Œä½¿ç”¨æ™‚é–“ (timestamp)
    }
  ],
  "terminals": [
    {
      "id": "wsl-ubuntu",                                    // çµ‚ç«¯ ID
      "name": "WSL Ubuntu",                                  // é¡¯ç¤ºåç¨±
      "icon": "ğŸ§",                                          // åœ–ç¤º
      "command": "wt.exe -w 0 new-tab wsl.exe -d Ubuntu --cd {path}",
      "pathFormat": "unix",                                  // "unix" | "windows"
      "isBuiltin": true                                      // æ˜¯å¦ç‚ºå…§å»º
    },
    {
      "id": "powershell",
      "name": "PowerShell",
      "icon": "âš¡",
      "command": "wt.exe -w 0 new-tab -p \"Windows PowerShell\" -d {path}",
      "pathFormat": "windows",
      "isBuiltin": true
    },
    {
      "id": "git-bash",
      "name": "Git Bash",
      "icon": "ğŸ±",
      "command": "\"C:\\Program Files\\Git\\git-bash.exe\" \"--cd={path}\"",
      "pathFormat": "windows",
      "isBuiltin": true
    }
  ],
  "groups": ["é è¨­"],
  "settings": {
    "autoLaunch": false,         // é–‹æ©Ÿè‡ªå‹•å•Ÿå‹•
    "startMinimized": false,     // å•Ÿå‹•æ™‚æœ€å°åŒ–
    "minimizeToTray": true,      // é—œé–‰æ™‚æœ€å°åŒ–åˆ°æ‰˜ç›¤
    "globalShortcut": "Alt+Space", // å…¨åŸŸå¿«æ·éµ
    "theme": "dark",             // ä¸»é¡Œ ("dark" | "light")
    "language": "zh-TW"          // èªè¨€ä»£ç¢¼
  }
}
```

### 3.5 çµ‚ç«¯å•Ÿå‹•æ¨¡çµ„

**è·¯å¾‘è½‰æ›è¦å‰‡**ï¼š

```
Windows: D:\Projects\my-app
   â†“
WSL:     /mnt/d/Projects/my-app
```

**éŒ¯èª¤é¡å‹**ï¼š

| éŒ¯èª¤é¡å‹                     | èªªæ˜                    |
| ---------------------------- | ----------------------- |
| `INVALID_CONFIG`             | çµ‚ç«¯é…ç½®ç„¡æ•ˆ            |
| `PATH_NOT_FOUND`             | ç›®éŒ„è·¯å¾‘ä¸å­˜åœ¨          |
| `PATH_NOT_DIRECTORY`         | è·¯å¾‘ä¸æ˜¯ç›®éŒ„            |
| `WINDOWS_TERMINAL_NOT_FOUND` | æœªå®‰è£ Windows Terminal |
| `WSL_NOT_FOUND`              | æœªå®‰è£ WSL              |
| `WSL_DISTRO_NOT_FOUND`       | æŒ‡å®šçš„ WSL ç™¼è¡Œç‰ˆä¸å­˜åœ¨ |
| `SPAWN_FAILED`               | å•Ÿå‹•ç¨‹åºå¤±æ•—            |

**å•Ÿå‹•å‘½ä»¤ç¯„ä¾‹**ï¼š

```bash
# WSL Ubuntu
wt.exe -w 0 new-tab wsl.exe -d Ubuntu --cd /mnt/d/Projects/my-app

# PowerShell
wt.exe -w 0 new-tab -p "Windows PowerShell" -d D:\Projects\my-app

# Git Bash
"C:\Program Files\Git\git-bash.exe" "--cd=D:\Projects\my-app"
```

### 3.6 IPC é€šè¨Šè¨­è¨ˆ

**ä¸»ç¨‹åºè™•ç†** (ipcMain.handle)

| Channel                 | åƒæ•¸      | å›å‚³       | èªªæ˜             |
| ----------------------- | --------- | ---------- | ---------------- |
| `get-config`            | -         | Config     | å–å¾—é…ç½®         |
| `save-config`           | Config    | boolean    | å„²å­˜é…ç½®         |
| `open-terminal`         | Directory | Result     | é–‹å•Ÿçµ‚ç«¯         |
| `select-folder`         | -         | {path}     | é–‹å•Ÿè³‡æ–™å¤¾é¸æ“‡å™¨ |
| `export-config`         | -         | {path}     | åŒ¯å‡ºé…ç½®æª”       |
| `import-config`         | -         | {config}   | åŒ¯å…¥é…ç½®æª”       |
| `get-auto-launch`       | -         | boolean    | å–å¾—é–‹æ©Ÿè‡ªå‹•å•Ÿå‹• |
| `set-auto-launch`       | boolean   | Result     | è¨­å®šé–‹æ©Ÿè‡ªå‹•å•Ÿå‹• |
| `get-available-locales` | -         | Locale[]   | å–å¾—å¯ç”¨èªç³»åˆ—è¡¨ |
| `load-locale`           | code      | LocaleData | è¼‰å…¥æŒ‡å®šèªç³»     |

**è¦–çª—æ§åˆ¶** (ipcRenderer.send)

| Channel           | èªªæ˜            |
| ----------------- | --------------- |
| `minimize-window` | æœ€å°åŒ–è¦–çª—      |
| `maximize-window` | æœ€å¤§åŒ–/é‚„åŸè¦–çª— |
| `close-window`    | é—œé–‰è¦–çª—        |

### 3.7 åœ‹éš›åŒ– (i18n) è¨­è¨ˆ

**èªç³»æª”æ¡ˆçµæ§‹** (`src/locales/zh-TW.json`)ï¼š

```json
{
  "meta": {
    "code": "zh-TW",
    "name": "Traditional Chinese",
    "nativeName": "ç¹é«”ä¸­æ–‡"
  },
  "ui": {
    "tabs": {
      "directories": "ğŸ“ ç›®éŒ„",
      "settings": "âš™ï¸ è¨­å®š"
    },
    "settings": {
      "general": {
        "theme": "ä¸»é¡Œ",
        "language": "èªè¨€"
      }
    }
  },
  "toast": {
    "directoryAdded": "ç›®éŒ„å·²æ–°å¢",
    "directoryDeleted": "ç›®éŒ„å·²åˆªé™¤"
  },
  "errors": {
    "PATH_NOT_FOUND": "è·¯å¾‘ä¸å­˜åœ¨ï¼š{path}"
  }
}
```

**å‰ç«¯ç¿»è­¯æ©Ÿåˆ¶**ï¼š

- ä½¿ç”¨ `data-i18n` å±¬æ€§æ¨™è¨˜éœ€è¦ç¿»è­¯çš„å…ƒç´ 
- `applyTranslations()` å‡½å¼è‡ªå‹•æƒæä¸¦æ›´æ–° DOM
- æ”¯æ´åƒæ•¸æ›¿æ› `{name}` èªæ³•

### 3.8 æ—¥èªŒè¨˜éŒ„æ¨¡çµ„

**æ—¥èªŒä½ç½®**ï¼š`%APPDATA%/termlauncher/logs/`

**æ—¥èªŒæª”å**ï¼š`termlauncher-YYYY-MM-DD.log`

**æ—¥èªŒç´šåˆ¥**ï¼š

| ç´šåˆ¥  | ç”¨é€”         |
| ----- | ------------ |
| DEBUG | é–‹ç™¼é™¤éŒ¯è³‡è¨Š |
| INFO  | ä¸€èˆ¬æ“ä½œè¨˜éŒ„ |
| WARN  | è­¦å‘Šè¨Šæ¯     |
| ERROR | éŒ¯èª¤è¨Šæ¯     |

**è¡Œç‚ºå·®ç•°**ï¼š

- é–‹ç™¼æ¨¡å¼ï¼šè¼¸å‡ºåˆ° console
- æ­£å¼ç‰ˆï¼šå¯«å…¥æ—¥èªŒæª”æ¡ˆï¼Œè‡ªå‹•æ¸…ç† 7 å¤©å‰çš„æ—¥èªŒ

---

## 4. è³‡æ–™æµç¨‹åœ–

### 4.1 é–‹å•Ÿçµ‚ç«¯æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    click     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç›®éŒ„å¡ç‰‡    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚  openTerminal â”‚
â”‚  (Renderer)  â”‚              â”‚  (Renderer)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚ window.electronAPI
                                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  preload.js  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  â”‚  ipcRenderer  â”‚
â”‚  (Bridge)    â”‚              â”‚  .invoke     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚ IPC
                                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  terminal.js â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  open-terminalâ”‚
â”‚  validate    â”‚              â”‚  (Main)      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ validation passed?
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   spawn      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  wt.exe      â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  terminal.js â”‚
â”‚  (System)    â”‚              â”‚  execute     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚ update lastUsed
                                     â†“
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  saveConfig  â”‚
                              â”‚  (Main)      â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 é…ç½®åŒæ­¥æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  è®Šæ›´   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  API   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UI æ“ä½œ    â”‚ â”€â”€â”€â”€â”€â”€â†’ â”‚  state.js   â”‚ â”€â”€â”€â”€â”€â†’ â”‚  preload.js  â”‚
â”‚  (Renderer) â”‚         â”‚  (Renderer) â”‚        â”‚  (Bridge)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                                      â”‚ IPC
                                                      â†“
                                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                               â”‚  save-config â”‚
                                               â”‚  (Main)      â”‚
                                               â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                                      â”‚ fs.writeFile
                                                      â†“
                                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                               â”‚ config.json â”‚
                                               â”‚  (Disk)     â”‚
                                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 ä¸»é¡Œåˆ‡æ›æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  select  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸»é¡Œé¸æ“‡å™¨  â”‚ â”€â”€â”€â”€â”€â”€â†’ â”‚ changeTheme â”‚
â”‚  (Renderer) â”‚          â”‚ (settings)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â†“                        â†“                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ applyTheme  â”‚          â”‚  saveConfig â”‚          â”‚  showToast  â”‚
â”‚ (CSS attr)  â”‚          â”‚  (persist)  â”‚          â”‚  (feedback) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. å®‰å…¨è€ƒé‡

### 5.1 Context Isolation

ä½¿ç”¨å®‰å…¨çš„ Electron è¨­å®šï¼š

```javascript
webPreferences: {
  nodeIntegration: false,
  contextIsolation: true,
  preload: path.join(__dirname, '../preload/preload.js'),
}
```

### 5.2 Content Security Policy

åœ¨ HTML ä¸­è¨­å®š CSPï¼š

```html
<meta
  http-equiv="Content-Security-Policy"
  content="default-src 'self';
               style-src 'self' https://fonts.googleapis.com;
               font-src 'self' https://fonts.gstatic.com;
               script-src 'self';"
/>
```

### 5.3 è·¯å¾‘è™•ç†

- ä½¿ç”¨ `spawn` è€Œé `exec`ï¼Œé¿å… shell æ³¨å…¥
- è·¯å¾‘åƒæ•¸ç›´æ¥å‚³éï¼Œä¸ç¶“é shell è§£æ
- å•Ÿå‹•å‰é©—è­‰è·¯å¾‘å­˜åœ¨æ€§

### 5.4 é…ç½®é©—è­‰

- è¼‰å…¥é…ç½®æ™‚æª¢æŸ¥çµæ§‹
- åŒ¯å…¥é…ç½®æ™‚é©—è­‰æ ¼å¼
- é…ç½®æå£æ™‚è‡ªå‹•å‚™ä»½ä¸¦ä½¿ç”¨é è¨­å€¼

---

## 6. æ‰“åŒ…é…ç½®

### 6.1 electron-builder é…ç½®

```json
{
  "build": {
    "appId": "com.termlauncher.app",
    "productName": "TermLauncher",
    "directories": {
      "output": "dist"
    },
    "files": ["src/**/*", "assets/**/*", "package.json"],
    "win": {
      "target": ["portable", "nsis"],
      "icon": "assets/icon.ico"
    },
    "portable": {
      "artifactName": "TermLauncher-Portable.exe"
    },
    "nsis": {
      "oneClick": false,
      "allowToChangeInstallationDirectory": true
    }
  }
}
```

### 6.2 è¼¸å‡ºæª”æ¡ˆ

| é¡å‹      | æª”å                        | èªªæ˜               |
| --------- | --------------------------- | ------------------ |
| Portable  | `TermLauncher-Portable.exe` | å…å®‰è£ç‰ˆï¼Œå–®ä¸€ exe |
| Installer | `TermLauncher-Setup.exe`    | å®‰è£ç‰ˆï¼Œå«æ·å¾‘å»ºç«‹ |

---

## 7. é–‹ç™¼ç’°å¢ƒ

### 7.1 ç’°å¢ƒéœ€æ±‚

```
Node.js >= 16.0.0
npm >= 8.0.0
Windows 10/11
Windows Terminal (å·²å®‰è£)
```

### 7.2 é–‹ç™¼æŒ‡ä»¤

```bash
# å®‰è£ä¾è³´
npm install

# é‹è¡Œæ‡‰ç”¨
npm start

# æ ¼å¼åŒ–ç¨‹å¼ç¢¼
npm run format

# æª¢æŸ¥æ ¼å¼
npm run format:check

# æ‰“åŒ… Portable ç‰ˆ
npm run build

# æ‰“åŒ…å®‰è£ç‰ˆ
npm run build:installer
```

---

## 8. éŒ¯èª¤è™•ç†

### 8.1 å¸¸è¦‹éŒ¯èª¤

| éŒ¯èª¤                    | åŸå›              | è™•ç†æ–¹å¼           |
| ----------------------- | ---------------- | ------------------ |
| Windows Terminal æœªå®‰è£ | ç³»çµ±æ²’æœ‰ wt.exe  | æç¤ºç”¨æˆ¶å®‰è£       |
| WSL æœªå®‰è£              | æ²’æœ‰ WSL ç’°å¢ƒ    | æç¤ºç”¨æˆ¶å®‰è£ WSL   |
| WSL ç™¼è¡Œç‰ˆä¸å­˜åœ¨        | æŒ‡å®šç™¼è¡Œç‰ˆæœªå®‰è£ | æç¤ºç”¨æˆ¶æª¢æŸ¥ç™¼è¡Œç‰ˆ |
| è·¯å¾‘ä¸å­˜åœ¨              | ç›®éŒ„å·²è¢«åˆªé™¤     | æç¤ºç”¨æˆ¶æª¢æŸ¥è·¯å¾‘   |
| é…ç½®æª”æå£              | JSON æ ¼å¼éŒ¯èª¤    | å‚™ä»½ä¸¦é‡å»ºé è¨­é…ç½® |
| å¿«æ·éµè¡çª              | å·²è¢«å…¶ä»–ç¨‹å¼ä½”ç”¨ | æç¤ºç”¨æˆ¶æ›´æ›       |

### 8.2 æ—¥èªŒè¨˜éŒ„

- é–‹ç™¼æ¨¡å¼ï¼šè¼¸å‡ºåˆ° console
- æ­£å¼ç‰ˆï¼šå¯«å…¥ `%APPDATA%/termlauncher/logs/`
- è‡ªå‹•æ¸…ç† 7 å¤©å‰çš„æ—¥èªŒæª”æ¡ˆ
